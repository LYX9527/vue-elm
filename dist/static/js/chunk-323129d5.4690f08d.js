(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-323129d5"],{"0e4a":function(t,e,s){},"45ed":function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"cont"}},[s("div",{staticClass:"nav"},[s("div",{staticClass:"ic",on:{click:function(e){return t.skip("home")}}},[s("icon",{staticClass:"icon_fs",attrs:{type:"arrowLeft"}})],1),s("span",{staticClass:"nav_title"},[t._v(t._s(t.shop.name))]),s("div",{staticClass:"ic"})]),s("div",{staticStyle:{width:"100%",height:"2.9rem"}}),s("div",{staticClass:"retail_title"},[s("div",[s("img",{attrs:{src:"https://elm.cangdu.org/img/"+t.shop.image_path,alt:""}})]),s("div",[s("p",[t._v(t._s(t.shop.name))]),s("p",[t._v("商家配送 / 分钟送达 / 配送费¥"+t._s(t.shop.float_delivery_fee))]),s("p",[t._v("公告："+t._s(t.shop.promotion_info))])]),s("div",[s("p",[t._v(" "+t._s(t.shop.activities&&t.shop.activities[0]?t.shop.activities[0].description:"无")+" ")]),s("p",[t._v(" "+t._s(t.shop.activities?t.shop.activities.length:0)+"个活动"),s("icon",{attrs:{type:"arrowRight"}})],1)]),s("div",{staticClass:"bg_img",style:{background:"url(https://elm.cangdu.org/img/"+t.shop.image_path+")"}})]),s("van-tabs",{staticStyle:{"margin-top":"0.5rem",position:"fixed",top:"10.9rem",width:"100%"}},[s("van-tab",{attrs:{title:"商品"}},[s("div",{staticClass:"menu"},[s("div",{staticClass:"box"},t._l(t.menus,(function(e,i){return s("a",{key:i,style:{backgroundColor:t.color==i?"#fff":"#efefef"},attrs:{href:"#chaper"+i},on:{click:function(e){return t.cheack(i)}}},[t._v(t._s(e.name))])})),0),s("div",{staticClass:"box"},[t._l(t.menus,(function(e,i){return s("div",{key:i,staticClass:"area"},[s("h1",{attrs:{id:"chaper"+i}},[s("span",[t._v(t._s(e.name)+" ")]),t._v(" "+t._s(e.description)+" "),s("span",[s("icon",{attrs:{type:"arrowRight"}})],1)]),t._l(e.foods,(function(e,i){return s("div",{key:i,staticClass:"grid"},[s("div",{on:{click:function(s){return s.stopPropagation(),t.changeGood(e)}}},[s("img",{attrs:{src:"https://elm.cangdu.org/img/"+e.image_path,alt:""}})]),s("div",[s("p",[t._v(t._s(e.name))]),s("p",[t._v("月售"+t._s(e.month_sales)+"份 好评率"+t._s(e.satisfy_rate)+"%")]),s("p",[s("span",{staticClass:"price"},[t._v("¥"+t._s(e["specfoods"][0]["price"]))]),1==e.specfoods.length?s("span",{staticClass:"btn"},[s("transition",{attrs:{name:"slide-fade"}},[s("span",{directives:[{name:"show",rawName:"v-show",value:t.cart[t.selfemployed.id]&&t.cart[t.selfemployed.id][e.specfoods[0].sku_id],expression:"\n                          cart[selfemployed.id] &&\n                          cart[selfemployed.id][m.specfoods[0].sku_id]\n                        "}],on:{click:function(s){return t.addcart({data:e.specfoods[0],type:"-",id:0,key:t.selfemployed.id})}}},[s("icon",{attrs:{type:"divide"}})],1)]),s("span",{staticStyle:{display:"inline-block",width:"1rem","text-align":"center"}},[t._v(t._s(t.cart[t.selfemployed.id]&&t.cart[t.selfemployed.id][e.specfoods[0].sku_id]?t.cart[t.selfemployed.id][e.specfoods[0].sku_id].quantity:""))]),s("span",{on:{click:function(s){return t.addcart({data:e.specfoods[0],type:"+",id:0,key:t.selfemployed.id})}}},[s("icon",{attrs:{type:"add"}})],1)],1):s("span",{staticClass:"btn"},[s("span",{staticClass:"change",on:{click:function(s){return t.chgshow(e)}}},[t._v("选规格")])])])])])}))],2)})),s("div",{staticStyle:{width:"100%",height:"4rem"}})],2)]),s("div",{staticClass:"foot",style:{zIndex:t.alert?2:3e3}},[s("div",{on:{click:function(e){t.show=!t.show}}},[s("div",[s("transition",{attrs:{appear:"",name:"animate__animated","enter-active-class":"animate__shakeY","leave-active-class":"animate__hinge"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.kit,expression:"kit"}]},[s("icon",{attrs:{type:"cart"}})],1)])],1),s("div",[s("p",[t._v("¥"+t._s(this.total)+"元")]),s("p",[t._v("配送费¥5")])])]),s("div",{style:{backgroundColor:20-this.total>0?"#555":"#4cd964"},on:{click:function(e){return t.submitCart()}}},[t._v(" "+t._s(20-this.total>0?"还差¥"+(20-this.total)+"起送":"去结算")+" ")])]),s("van-action-sheet",{attrs:{title:"购物车"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[s("div",{staticClass:"shopp"},[s("ul",{staticStyle:{position:"relative"}},[s("li",{staticClass:"line line_bottom"},[s("div",[t._v("商品名称")]),s("div",[t._v("商品单价")]),s("div",[t._v("商品总价")]),s("div",[t._v("商品个数")])]),s("li",{staticStyle:{height:"2rem"}}),s("li",{staticClass:"line line_top"},[s("div",[t._v("购物车")]),s("div"),s("div"),s("div",{on:{click:function(e){return t.clCart(t.selfemployed.id)}}},[s("icon",{attrs:{type:"trash"}}),t._v("清空购物车 ")],1)]),t._l(t.carts,(function(e,i){return s("li",{key:i,staticClass:"line"},[s("div",[t._v(" "+t._s(t._f("texthidden")(e.specs.length>0?"("+e.specs[0].value+")":""))+t._s(t._f("texthidden")(e.name))+" ")]),s("div",[t._v(" "+t._s(e.price)+" ")]),s("div",[t._v(" "+t._s(e.price*e.quantity)+" ")]),s("div",[s("span",{on:{click:function(s){return t.addcart({data:0,type:"-",id:e.sku_id,key:t.selfemployed.id})}}},[s("icon",{attrs:{type:"divide"}})],1),t._v(" "+t._s(e.quantity)+" "),s("span",{on:{click:function(s){return t.addcart({data:0,type:"+",id:e.sku_id,key:t.selfemployed.id})}}},[s("icon",{attrs:{type:"add"}})],1)])])}))],2)])]),s("van-popup",{attrs:{round:"",closeable:"",overlay:!0},model:{value:t.alert,callback:function(e){t.alert=e},expression:"alert"}},[s("div",{staticClass:"alert",staticStyle:{width:"20rem",height:"15rem"}},[s("div",[t._v(" "+t._s(t.showcont.name)+" ")]),s("div",[s("p",[t._v("规格")]),s("p",t._l(t.showcont.specfoods,(function(e,i){return s("span",{key:i,class:t.id==e.sku_id?"checked":"unchecked",on:{click:function(s){return t.chrule(e)}}},[t._v(t._s(e.specs_name)+" ")])})),0)]),s("div",[s("div",[t._v("¥"+t._s(t.checked.price?t.checked.price:0))]),s("div",[s("span",{on:{click:t.ruleAddcart}},[t._v("加入购物车")])])])])])],1),s("van-tab",{staticClass:"grade_box",staticStyle:{"background-color":"#efefef"},attrs:{title:"评价"}},[s("div",{staticClass:"grade_title"},[s("div",[s("p",[t._v(t._s(t.score?t.score.food_score.toFixed(1):"NaN"))]),s("p",[t._v("综合评价")]),s("p",[t._v(" 高于周边商家"+t._s(t.score?(100*t.score.compare_rating).toFixed(2)+"%":"NaN")+" ")])]),s("div",[s("p",[t._v(" 服务态度 "),s("van-rate",{attrs:{"allow-half":"","void-icon":"star","void-color":"#eee",size:"10"},model:{value:t.score.overall_score,callback:function(e){t.$set(t.score,"overall_score",e)},expression:"score.overall_score"}}),s("span",{staticClass:"reg"},[t._v(t._s(t.score&&t.score.overall_score?t.score.overall_score.toFixed(1):0))])],1),s("p",[t._v(" 菜品评价"),s("van-rate",{attrs:{"allow-half":"","void-icon":"star","void-color":"#eee",size:"10"},model:{value:t.score.service_score,callback:function(e){t.$set(t.score,"service_score",e)},expression:"score.service_score"}}),s("span",{staticClass:"reg"},[t._v(t._s(t.score&&t.score.service_score?t.score.service_score.toFixed(1):0))])],1),s("p",[t._v(" 送达时间 "),s("span",[t._v(t._s(t.score?t.score.deliver_time:"NaN"))]),s("span",[t._v("分钟")])])])]),s("div",{staticClass:"grade_body"},t._l(t.grade,(function(e,i){return s("div",{key:i,class:t.gradeid==i?"checkgrade":"",on:{click:function(e){return t.checkGrade(i)}}},[t._v(" "+t._s(e.name)+"("+t._s(e.count)+") ")])})),0),s("div",{staticClass:"grade_content"},t._l(t.gradetotal,(function(e,i){return s("div",{key:i},[s("div",[s("img",{attrs:{src:"",alt:""}})]),s("div",[s("p",[t._v(" "+t._s(e.username)+" "),s("span",[t._v(t._s(e.rated_at))])]),s("p",[s("van-rate",{attrs:{"allow-half":"","void-icon":"star","void-color":"#eee",size:"10"},model:{value:e.rating_star,callback:function(s){t.$set(e,"rating_star",s)},expression:"v.rating_star"}}),s("span",[t._v(t._s(e.time_spent_desc?e.time_spent_desc:""))])],1),s("div",[e.item_ratings&&e.item_ratings[0]?s("img",{attrs:{src:e.item_ratings&&e.item_ratings[0]?"https://fuss10.elemecdn.com/d/c8/"+e.item_ratings[0].image_hash+".jpeg":"",alt:""}}):t._e()])])])})),0)])],1)],1)},a=[],c=s("5530"),o=(s("159b"),s("b64b"),s("a434"),s("d3b7"),s("25f0"),s("2f62")),n={data:function(){return{status:!0,activeKey:0,shop:"",menus:"",color:0,carts:[],show:!1,total:0,alert:!1,showcont:"",ruleprice:0,id:"",checked:"",gradetotal:"",score:"",grade:"",gradeid:0,kit:!0}},methods:Object(c["a"])(Object(c["a"])({},Object(o["b"])(["chCart","clearCart","chFood","saveCarts"])),{},{getRest:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3276;this.$http({method:"get",url:"https://elm.cangdu.org/shopping/restaurant/".concat(e)}).then((function(e){t.shop=e.data}))},getMenu:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3276;this.$http({method:"get",url:"https://elm.cangdu.org/shopping/v2/menu?restaurant_id=".concat(e)}).then((function(e){t.menus=e.data}))},cheack:function(t){this.color=t},addcart:function(t){this.chCart(t),this.showCart(),this.kit=!this.kit,this.kit=!this.kit},submitCart:function(){this.saveCarts(this.carts),this.skip("submitorder")},showCart:function(){var t=this;if(this.cart[this.selfemployed.id]){var e,s;e=[],s=[],this.total=0,Object.keys(this.cart[this.selfemployed.id]).forEach((function(t){e.push(t)}));for(var i=0;i<e.length;i++)s.push(this.cart[this.selfemployed.id][e[i]]);s.forEach((function(t,e){0==t.quantity&&s.splice(e,1)})),this.carts=s,s.forEach((function(e,s){t.total+=e.quantity*e.price}))}else this.carts=[],this.total=0},clCart:function(t){this.clearCart(t),this.showCart()},chgshow:function(t){this.showcont=t,this.alert=!0},chrule:function(t){this.id=t.sku_id,this.checked=t},ruleAddcart:function(){this.id&&this.addcart({data:this.checked,type:"+",id:0,key:this.selfemployed.id}),this.checked="",this.alert=!1,this.id=0},getGrade:function(t){var e=this;this.$http({method:"get",url:"https://elm.cangdu.org/ugc/v2/restaurants/".concat(t,"/ratings")}).then((function(t){e.gradetotal=t.data})),this.$http({method:"get",url:"https://elm.cangdu.org/ugc/v2/restaurants/".concat(t,"/ratings/tags")}).then((function(t){e.grade=t.data})),this.$http({method:"get",url:"https://elm.cangdu.org/ugc/v2/restaurants/".concat(t,"/ratings/scores")}).then((function(t){e.score=t.data}))},checkGrade:function(t){this.gradeid=t},changeGood:function(t){this.chFood(t),this.skip("goods")}}),created:function(){this.getRest(this.selfemployed.id),this.getMenu(this.selfemployed.id),this.getGrade(this.selfemployed.id),this.showCart()},computed:Object(c["a"])({},Object(o["c"])(["selfemployed","cart"])),filters:{texthidden:function(t){return t.length>6?t.toString().substring(0,5)+"...":t}}},r=n,d=(s("e506"),s("2877")),l=Object(d["a"])(r,i,a,!1,null,"5b3bc117",null);e["default"]=l.exports},e506:function(t,e,s){"use strict";s("0e4a")}}]);